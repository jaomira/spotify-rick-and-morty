<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Guia Educacional - API Demo (Express)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body { padding-top: 3.5rem; }
      pre { white-space: pre-wrap; }
      .response-area { max-height: 300px; overflow: auto; }
      code.cmd { background: #f8f9fa; padding: .1rem .4rem; border-radius: .25rem; display: inline-block; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Guia Educacional - API Demo</a>
      </div>
    </nav>

    <main class="container">
      <div class="py-5 text-center">
        <h1>Guia Educacional: projeto API Demo (Node + Express)</h1>
        <p class="lead">Página educativa com explicação passo-a-passo, comandos e exemplos para entender, executar e testar a API didática presente no repositório.</p>
      </div>

      <section class="mb-4">
        <h3>O que este projeto contém</h3>
        <ul>
          <li><strong>Servidor Express</strong> em <code>server.js</code> que expõe uma API CRUD simples em <code>/api/items</code> (em memória).</li>
          <li>Uma interface de demonstração em <code>api-demo-express.html</code> que consome a API local.</li>
          <li>Uma página genérica <code>api-demo.html</code> para testar qualquer API pública (usa jsonplaceholder por padrão).</li>
          <li>Instruções nos READMEs sobre como rodar e experimentar.</li>
        </ul>
      </section>

      <section class="mb-4">
        <h3>Como instalar e executar (passo-a-passo)</h3>
        <p>Abra o PowerShell na pasta do projeto (<code>d:\Ramon\Unex\2 - API\Atividade de API\rest</code>) e execute:</p>
        <pre><code class="cmd">npm install</code></pre>
        <p>Depois, inicie o servidor:</p>
        <pre><code class="cmd">npm start</code></pre>
        <p>O servidor ficará disponível em <code>http://localhost:3000</code>. Abra essa URL no navegador para ver <code>api-demo-express.html</code>.</p>
      </section>

      <section class="mb-4">
        <h3>Endpoints disponíveis</h3>
        <ul>
          <li><code>GET /api/items</code> — lista todos os itens.</li>
          <li><code>GET /api/items/:id</code> — obtém item pelo <code>id</code>.</li>
          <li><code>POST /api/items</code> — cria um item. Body JSON: <code>{ "title": "texto", "body": "texto opcional" }</code>. O campo <code>title</code> é obrigatório.</li>
          <li><code>PUT /api/items/:id</code> — atualiza um item. Envie campos que deseja atualizar (title/body).</li>
          <li><code>DELETE /api/items/:id</code> — remove um item pelo <code>id</code>.</li>
        </ul>
        <p>Observação: os dados são mantidos em memória — reiniciar o servidor reseta tudo.</p>
      </section>

      <section class="mb-4">
        <h3>Exemplos práticos</h3>
        <h5>Usando PowerShell (Invoke-RestMethod)</h5>
        <pre><code class="cmd"># Listar
Invoke-RestMethod -Uri http://localhost:3000/api/items -Method GET

# Criar
Invoke-RestMethod -Uri http://localhost:3000/api/items -Method POST -Body (ConvertTo-Json @{ title = 'Meu título'; body = 'Meu corpo' }) -ContentType 'application/json'

# Atualizar
Invoke-RestMethod -Uri http://localhost:3000/api/items/1 -Method PUT -Body (ConvertTo-Json @{ title = 'Novo título' }) -ContentType 'application/json'

# Remover
Invoke-RestMethod -Uri http://localhost:3000/api/items/1 -Method DELETE</code></pre>

        <h5>Usando curl (WSL/Windows com curl instalado)</h5>
        <pre><code class="cmd">curl http://localhost:3000/api/items

curl -X POST http://localhost:3000/api/items -H "Content-Type: application/json" -d '{"title":"Teste","body":"corpo"}'

curl -X PUT http://localhost:3000/api/items/1 -H "Content-Type: application/json" -d '{"title":"Atualizado"}'

curl -X DELETE http://localhost:3000/api/items/1</code></pre>

        <h5>Usando fetch (exemplo JS)</h5>
        <pre><code class="cmd">// GET
fetch('/api/items').then(r =&gt; r.json()).then(console.log)

// POST
fetch('/api/items', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ title: 'x', body: 'y' }) }).then(r =&gt; r.json()).then(console.log)
</code></pre>
      </section>

      <section class="mb-4">
        <h3>Try it — testar direto desta página (quando o servidor estiver rodando)</h3>
        <p>Se o servidor Express estiver rodando e você abrir esta página pelo próprio servidor (<code>http://localhost:3000/api-educacional.html</code>), use os controles abaixo para testar a API.</p>

        <div class="card mb-3">
          <div class="card-body">
            <div class="row g-2">
              <div class="col-md-3">
                <button id="btnList" class="btn btn-success w-100">Listar (GET)</button>
              </div>
              <div class="col-md-3">
                <input id="createTitle" class="form-control" placeholder="Título (POST)" />
              </div>
              <div class="col-md-3">
                <input id="createBody" class="form-control" placeholder="Corpo (POST)" />
              </div>
              <div class="col-md-3">
                <button id="btnCreate" class="btn btn-primary w-100">Criar (POST)</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-body response-area">
            <pre id="log" class="bg-light p-3 border rounded">Pronto.</pre>
          </div>
        </div>
      </section>

      <!-- <section class="mb-5">
        <h3>Exercícios sugeridos (para alunos)</h3>
        <ol>
          <li>Modificar o código para salvar os itens em um arquivo JSON em vez de memória.</li>
          <li>Adicionar paginação ao endpoint <code>GET /api/items</code>.</li>
          <li>Adicionar validação com <code>express-validator</code> ou checar campos manualmente.</li>
          <li>Proteger um endpoint com token simples (ex.: header <code>Authorization</code>).</li>
        </ol>
      </section> -->

      <footer class="text-center mb-5">
        <small>Projeto original: API Demo Express.</small>
      </footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const logEl = document.getElementById('log');
      function log(msg, json) {
        const time = new Date().toLocaleTimeString();
        if (json) logEl.textContent = `[${time}] ${msg}\n` + JSON.stringify(json, null, 2) + "\n\n" + logEl.textContent;
        else logEl.textContent = `[${time}] ${msg}\n\n` + logEl.textContent;
      }

      async function request(url, options = {}) {
        log(`Request: ${options.method || 'GET'} ${url}`);
        try {
          const res = await fetch(url, options);
          const ct = res.headers.get('content-type') || '';
          const body = ct.includes('application/json') ? await res.json() : await res.text();
          log(`Status: ${res.status} ${res.statusText}`, body);
          return { res, body };
        } catch (err) {
          log(`Erro: ${err.message}`);
          console.error(err);
        }
      }

  document.getElementById('btnList').addEventListener('click', async () => { await request('/api/items'); });
  document.getElementById('btnCreate').addEventListener('click', async () => {
        const title = document.getElementById('createTitle').value;
        const body = document.getElementById('createBody').value;
        if (!title) return log('Informe um título');
        await request('/api/items', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ title, body }) });
      });
    </script>
  </body>
</html>